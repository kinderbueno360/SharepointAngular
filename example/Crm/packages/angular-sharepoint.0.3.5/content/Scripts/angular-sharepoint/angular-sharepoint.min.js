"use strict";angular.module("ExpertsInside.SharePoint.Core",["ng"]).run(["$window","$log",function(a,b){angular.isUndefined(a.ShareCoffee)&&b.warn("ExpertsInside.SharePoint.Core module depends on ShareCoffee. Please include ShareCoffee.js in your document")}]),angular.module("ExpertsInside.SharePoint.List",["ExpertsInside.SharePoint.Core"]),angular.module("ExpertsInside.SharePoint.Search",["ExpertsInside.SharePoint.Core"]).run(["$window","$log",function(a,b){(angular.isUndefined(a.ShareCoffee)||angular.isUndefined(a.ShareCoffee.QueryProperties))&&b.warn("ExpertsInside.SharePoint.Search module depends on ShareCoffee.Search. Please include ShareCoffee.Search.js in your document")}]),angular.module("ExpertsInside.SharePoint.User",["ExpertsInside.SharePoint.Core"]).run(["$window","$log",function(a,b){(angular.isUndefined(a.ShareCoffee)||angular.isUndefined(a.ShareCoffee.UserProfileProperties))&&b.warn("ExpertsInside.SharePoint.User module depends on ShareCoffee.UserProfiles. Please include ShareCoffee.UserProfiles.js in your document")}]),angular.module("ExpertsInside.SharePoint.JSOM",[]).run(["$window","$log",function(a,b){(angular.isUndefined(a.SP)||angular.isUndefined(a.SP.ClientContext))&&b.warn("ExpertsInside.SharePoint.JSOM module depends on the SharePoint Javascript Runtime. For more information see: http://blogs.msdn.com/b/officeapps/archive/2012/09/04/using-the-javascript-object-model-jsom-in-apps-for-sharepoint.aspx")}]),angular.module("ExpertsInside.SharePoint",["ExpertsInside.SharePoint.Core","ExpertsInside.SharePoint.List","ExpertsInside.SharePoint.Search","ExpertsInside.SharePoint.User"]),angular.module("ExpertsInside.SharePoint.JSOM").factory("$spClientContext",["$window","$q",function(a,b){var c={$$decorateContext:function(c){return c.$$empowered=!0,c.$$awaitingLoads=[],c.$load=function(){var d=Array.prototype.slice.call(arguments,0),e=b.defer();return a.SP.ClientContext.prototype.load.apply(c,arguments),c.$$awaitingLoads.push({deferred:e,args:d}),e.promise},c.$executeQueryAsync=function(){var a=b.defer();return c.executeQueryAsync(function(){angular.forEach(c.$$awaitingLoads,function(a){var b=a.deferred;b.resolve.apply(b,a.args)}),a.resolve(c),c.$$awaitingLoads.length=0},function(){var b=arguments;angular.forEach(c.$$awaitingLoads,function(a){var c=a.deferred;c.reject.apply(c,b)}),a.reject.apply(a,b),c.$$awaitingLoads.length=0}),a.promise},c},create:function(b){var d=new a.SP.ClientContext(b);return c.$$decorateContext(d)},current:function(){var b=new a.SP.ClientContext.get_current;return angular.isDefined(b.$$empowered)?b:c.$$decorateContext(b)}};return c}]),angular.module("ExpertsInside.SharePoint.Core").factory("$spConvert",function(){var a=function(a,c){if(!angular.isObject(c.__metadata)||c.__metadata.type!==a)throw b("badargs","expected argument to be of type {0}.",a)},b=angular.$$minErr("$spConvert"),c={spKeyValue:function(b){a("SP.KeyValue",b);var c=b.Value;switch(b.ValueType){case"Edm.Double":case"Edm.Float":return parseFloat(c);case"Edm.Int16":case"Edm.Int32":case"Edm.Int64":case"Edm.Byte":return parseInt(c,10);case"Edm.Boolean":return"true"===c;default:return c}},spKeyValueArray:function(a){for(var b={},d=0,e=a.length;e>d;d+=1){var f=a[d],g=f.Key;b[g]=c.spKeyValue(f)}return b},spSimpleDataRow:function(b){a("SP.SimpleDataRow",b);var d=b.Cells.results||[];return c.spKeyValueArray(d)},spSimpleDataTable:function(b){a("SP.SimpleDataTable",b);for(var d=[],e=b.Rows.results||[],f=0,g=e.length;g>f;f+=1){var h=e[f];d.push(c.spSimpleDataRow(h))}return d},searchResult:function(b){a("Microsoft.Office.Server.Search.REST.SearchResult",b);var d=b.PrimaryQueryResult,e={elapsedTime:b.ElapsedTime,spellingSuggestion:b.SpellingSuggestion,properties:c.spKeyValueArray(b.Properties.results),primaryQueryResult:{queryId:d.QueryId,queryRuleId:d.QueryRuleId,relevantResults:c.spSimpleDataTable(d.RelevantResults.Table),customResults:d.CustomResults,refinementResults:d.RefinementResults,specialTermResults:d.SpecialTermResults}};return e},suggestResult:function(a){return a},userResult:function(b){a("SP.UserProfiles.PersonProperties",b);var d={accountName:b.AccountName,displayName:b.DisplayName,email:b.Email,isFollowed:b.IsFollowed,personalUrl:b.PersonalUrl,pictureUrl:b.PictureUrl,profileProperties:c.spKeyValueArray(b.UserProfileProperties.results),title:b.Title,userUrl:b.UserUrl};return d},capitalize:function(a){return angular.isUndefined(a)||null===a?null:a.charAt(0).toUpperCase()+a.slice(1)}};return c}),angular.module("ExpertsInside.SharePoint.List").factory("$spList",["$spRest","$http","$spConvert",function($spRest,$http,$spConvert){function listFactory(title,listOptions){if(!angular.isString(title)||""===title)throw $spListMinErr("badargs","title must be a nen-empty string.");angular.isObject(listOptions)||(listOptions={});var normalizedTitle=$spConvert.capitalize(title.replace(/[^A-Za-z0-9 ]/g,"").replace(/\s/g,"_x0020_")),className=$spConvert.capitalize(normalizedTitle.replace(/_x0020/g,"").replace(/^\d+/,"")),listItemType="SP.Data."+normalizedTitle+"ListItem",List=function(){function __List__(a){this.__metadata={type:listItemType},angular.extend(this,a)}var script=" (function() {                     "+__List__.toString()+"   return __List__;                 })();                             ";return eval(script.replace(/__List__/g,className))}();return List.$$title=title,List.$$queryParameterWhitelist=["$select","$filter","$orderby","$top","$skip","$expand","$sort"],List.$$relativeUrl="web/lists/getByTitle('"+List.$$title+"')",List.$$inHostWeb=listOptions.inHostWeb,List.$$decorateResult=function(a,b){return angular.isArray(a)||a instanceof List||(a=new List(a)),angular.isUndefined(a.$resolved)&&(a.$resolved=!1),a.$promise=$http(b).then(function(b){var c=b.data;if(angular.isArray(a)&&angular.isArray(c))angular.forEach(c,function(b){a.push(new List(b))});else{if(!angular.isObject(a))throw $spListMinErr("badresponse","Expected response to contain an {0} but got an {1}",angular.isArray(a)?"array":"object",angular.isArray(c)?"array":"object");if(angular.isArray(c)){if(1!==c.length)throw $spListMinErr("badresponse","Expected response to contain an array with one object but got {1}",c.length);angular.extend(a,c[0])}else angular.isObject(c)&&angular.extend(a,c)}var d;return 204===b.status&&angular.isString(d=b.headers("ETag"))&&(a.__metadata.etag=d),a.$resolved=!0,a}),a},List.$$buildHttpConfig=function(a,b){var c=List.$$relativeUrl+"/items",d={url:c};angular.isString(List.$$inHostWeb)?d.hostWebUrl=List.$$inHostWeb:List.$$inHostWeb&&(d.hostWebUrl=ShareCoffee.Commons.getHostWebUrl()),a=angular.isString(a)?a.toLowerCase():"",b=angular.isDefined(b)?b:{};var e=angular.isDefined(b.query)?$spRest.normalizeParams(b.query,List.$$queryParameterWhitelist):{};switch(a){case"get":if(angular.isUndefined(b.id))throw $spListMinErr("options:get","options must have an id");d.url+="("+b.id+")",d=ShareCoffee.REST.build.read["for"].angularJS(d);break;case"query":d=ShareCoffee.REST.build.read["for"].angularJS(d);break;case"create":if(angular.isUndefined(b.item))throw $spListMinErr("options:create","options must have an item");if(angular.isUndefined(b.item.__metadata))throw $spListMinErr("options:create","options.item must have __metadata property");angular.isDefined(e)&&delete e.$expand,d.payload=b.item.$toJson(),d=ShareCoffee.REST.build.create["for"].angularJS(d);break;case"update":if(angular.isUndefined(b.item))throw $spListMinErr("options:update","options must have an item");if(angular.isUndefined(b.item.__metadata))throw $spListMinErr("options:create","options.item must have __metadata property");e={},d.url+="("+b.item.Id+")",d.payload=b.item.$toJson(),d.eTag=!b.force&&angular.isDefined(b.item.__metadata)?b.item.__metadata.etag:null,d=ShareCoffee.REST.build.update["for"].angularJS(d);break;case"delete":if(angular.isUndefined(b.item))throw $spListMinErr("options:delete","options must have an item");if(angular.isUndefined(b.item.__metadata))throw $spListMinErr("options:delete","options.item must have __metadata");d.url+="("+b.item.Id+")",d=ShareCoffee.REST.build["delete"]["for"].angularJS(d)}return d.url=$spRest.appendQueryParameters(d.url,e),d.transformResponse=$spRest.transformResponse,d},List.get=function(a,b){if(angular.isUndefined(a)||null===a)throw $spListMinErr("badargs","id is required.");var c={Id:a},d=List.$$buildHttpConfig("get",{id:a,query:b});return List.$$decorateResult(c,d)},List.query=function(a,b){var c=angular.isDefined(b)&&b.singleResult?{}:[],d=List.$$buildHttpConfig("query",{query:angular.extend({},List.prototype.$$queryDefaults,a)});return List.$$decorateResult(c,d)},List.create=function(a,b){if(!(angular.isObject(a)&&a instanceof List))throw $spListMinErr("badargs","item must be a List instance.");a.__metadata=angular.extend({type:listItemType},a.__metadata);var c=List.$$buildHttpConfig("create",{item:a,query:angular.extend({},a.$$queryDefaults,b)});return List.$$decorateResult(a,c)},List.update=function(a,b){if(!(angular.isObject(a)&&a instanceof List))throw $spListMinErr("badargs","item must be a List instance.");b=angular.extend({},b,{item:a});var c=List.$$buildHttpConfig("update",b);return List.$$decorateResult(a,c)},List.save=function(a,b){if(angular.isDefined(a.__metadata)&&angular.isDefined(a.__metadata.id))return this.update(a,b);var c=angular.isObject(b)?b.query:void 0;return this.create(a,c)},List.delete=function(a){if(!(angular.isObject(a)&&a instanceof List))throw $spListMinErr("badargs","item must be a List instance.");var b=List.$$buildHttpConfig("delete",{item:a});return List.$$decorateResult(a,b)},List.queries={},List.addNamedQuery=function(a,b,c){return List.queries[a]=function(){var a=angular.extend({},List.prototype.$$queryDefaults,b.apply(List,arguments));return List.query(a,c)},List},List.toJson=function(a){var b={},c=angular.extend([],a.$$readOnlyFields);return angular.forEach(a,function(a,d){0!==d.indexOf("$")&&-1===c.indexOf(d)&&(b[d]=a)}),angular.toJson(b)},List.prototype={$$readOnlyFields:angular.extend(["AttachmentFiles","Attachments","Author","AuthorId","ContentType","ContentTypeId","Created","Editor","EditorId","FieldValuesAsHtml","FieldValuesAsText","FieldValuesForEdit","File","FileSystemObjectType","FirstUniqueAncestorSecurableObject","Folder","GUID","Modified","OData__UIVersionString","ParentList","RoleAssignments"],listOptions.readOnlyFields),$$queryDefaults:angular.extend({},listOptions.query),$save:function(a){return List.save(this,a).$promise},$delete:function(){return List.delete(this).$promise},$isNew:function(){return angular.isUndefined(this.__metadata)||angular.isUndefined(this.__metadata.id)},$toJson:function(){return List.toJson(this)}},List}var $spListMinErr=angular.$$minErr("$spList");return listFactory}]),angular.module("ExpertsInside.SharePoint.Core").factory("$spPageContextInfo",["$rootScope","$window",function(a,b){var c={};return angular.copy(b._spPageContextInfo,c),a.$watch(function(){return b._spPageContextInfo},function(a){angular.copy(a,c)},!0),c}]),angular.module("ExpertsInside.SharePoint.Core").factory("$spRest",["$log",function(a){function b(a){var b=[];if(angular.isUndefined(a)||null===a)return b;for(var c in a)a.hasOwnProperty(c)&&b.push(c);return b.sort()}var c=function(a){return a.reduce(function(a,b){return a.indexOf(b)<0&&a.push(b),a},[])},d={transformResponse:function(a){var b={};return angular.isDefined(a)&&null!==a&&""!==a&&(b=angular.fromJson(a)),angular.isObject(b)&&angular.isDefined(b.d)&&(b=b.d),angular.isObject(b)&&angular.isDefined(b.results)&&(b=b.results),b},buildQueryString:function(a){var d=[],e=b(a);angular.forEach(e,function(b){var e=a[b];null===e||angular.isUndefined(e)||(angular.isArray(e)&&(e=c(e).join(",")),angular.isObject(e)&&(e=angular.toJson(e)),d.push(b+"="+e))});var f=d.join("&");return f},normalizeParams:function(b,c){return b=angular.extend({},b),angular.isDefined(b)&&angular.forEach(b,function(d,e){0!==e.indexOf("$")&&(delete b[e],e="$"+e,b[e]=d),angular.isDefined(c)&&-1===c.indexOf(e)&&(a.warn("Invalid param key detected: "+e),delete b[e])}),(null===b||"{}"===JSON.stringify(b))&&(b=void 0),b},appendQueryParameters:function(a,b){var c=d.buildQueryString(b);return""!==c&&(a+=(-1===a.indexOf("?")?"?":"&")+c),a}};return d}]),angular.module("ExpertsInside.SharePoint.Search").factory("$spSearch",["$http","$spRest","$spConvert",function(a,b,c){var d=angular.$$minErr("$spSearch"),e={$$createQueryProperties:function(a,b){var c;switch(a){case"postquery":c=new ShareCoffee.PostQueryProperties;break;case"suggest":c=new ShareCoffee.SuggestProperties;break;default:c=new ShareCoffee.QueryProperties}return angular.extend(c,b)},$decorateResult:function(b,e){return angular.isUndefined(b.$resolved)&&(b.$resolved=!1),b.$raw=null,b.$promise=a(e).then(function(a){var e=a.data;if(angular.isObject(e)&&(angular.isDefined(e.query)?(b.$raw=e.query,angular.extend(b,c.searchResult(e.query))):angular.isDefined(e.suggest)&&(b.$raw=e.suggest,angular.extend(b,c.suggestResult(e.suggest)))),angular.isUndefined(b.$raw))throw d("badresponse","Response does not contain a valid search result.");return b.$resolved=!0,b}),b},query:function(a){a=angular.extend({},a);var c=a.searchType;delete a.searchType;var d=e.$$createQueryProperties(c,a),f=ShareCoffee.REST.build.read["for"].angularJS(d);f.transformResponse=b.transformResponse;var g={};return e.$decorateResult(g,f)},postquery:function(a){return a=angular.extend(a,{searchType:"postquery"}),e.query(a)},suggest:function(a){return a=angular.extend(a,{searchType:"suggest"}),e.query(a)}};return e}]),angular.module("ExpertsInside.SharePoint.User").factory("$spUser",["$http","$spRest","$spConvert",function(a,b,c){var d=angular.$$minErr("$spUser"),e={$$decorateResult:function(b,e){return angular.isUndefined(b.$resolved)&&(b.$resolved=!1),b.$raw=null,b.$promise=a(e).then(function(a){var e=a.data;if(!angular.isDefined(e))throw d("badresponse","Response does not contain a valid user result.");return b.$raw=e,angular.extend(b,c.userResult(e)),b.$resolved=!0,b}),b},current:function(){var a=new ShareCoffee.UserProfileProperties(ShareCoffee.Url.GetMyProperties),c=ShareCoffee.REST.build.read.f.angularJS(a);c.transformResponse=b.transformResponse;var d={};return e.$$decorateResult(d,c)},get:function(a){var c=new ShareCoffee.UserProfileProperties(ShareCoffee.Url.GetProperties,a),d=ShareCoffee.REST.build.read.f.angularJS(c);d.transformResponse=b.transformResponse;var f={};return e.$$decorateResult(f,d)}};return e}]);
//# sourceMappingURL=angular-sharepoint.min.map